---
layout: post
title: "单线程和多线程进程模型"
tag: os
category: essay
---

## 多线程

多线程指在单个进程内支持多个并发路径的能力。

**单线程方法**：每个进程中仅执行单个线程的方法。如MS-DOS支持单用户进程的单线程方法，早期版本的UNIX支持多用户进程的单线程方法。

**多线程方法**：在每个进程中支持多个并发路径的方法。如JVM支持多线程方法。

![Thread and processes](/assets/os_8.png)

## 线程模型

**单线程进程模型**：进程的表示包括VAS和PCB，以及用户栈和内核栈。在进程运行时，寄存器由进程控制；在进程就绪时，寄存器保存到PCB中。

**多线程进程模型**：进程的表示包括VAS与PCB（由所有线程共享），每个线程有独立的TCB（线程控制块）和独立的用户栈及内核栈。线程作为调度的基本单位，TCB保持有自己的线程状态及寄存器上下文。

![Single-Threaded and Multithreaded Process Models](/assets/os_9.png)

使用线程的优点包括：

1. 在已有进程中创建、终止、切换线程的时间远小于创建、终止、切换进程的时间
2. 线程提高了不同执行程序的通信效率；IPC大多需要内核接入，而同一进程的多个线程共享内存和文件，无需内核介入就可共享数据。

