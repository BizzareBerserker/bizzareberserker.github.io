---
layout: post
title: "随机变量的联合分布"
tag: probability
category: essay
---

## 联合分布函数

**二维随机变量**：对于试验$E$和样本空间$\Omega$，$X,Y$是样本空间$\Omega$的两个变量，那么称$(X,Y)$ 为一个二维随机变量

### 连续型随机变量

**联合概率分布函数** (joint cumulative probability distribution function)：
$$
F(x, y)=P\{X\le a,Y\le b\}\qquad -\infin<a,b<+\infin
$$

- 性质：

  - $0\le F(x,y)\le 1$

  - $F(x,y)$非降

  - $$
    F(-\infin,0)=0\qquad F(0,-\infin)=0\\
    F(-\infin,-\infin)=0\qquad F(+\infin, +\infin)=1
    $$

  - $F(x,y)$关于$x$和$y$右连续

  - For $x_1<x_2\quad y_1<y_2$
    $$
    P\{x_1<X\le x_2, y_1<Y\le y_2\}=F(x_2,y_2)-F(x_2,y_1)-F(x_1,y_2)+F(x_1,y_1)
    $$
  
- **n个随机变量的联合分布**：对于$n$个随机变量$X_1,X_2,\cdots,X_n$联合分布函数$F(x_1,x_2,\cdots,x_n)$为

$$
F(x_1,x_2,\cdots,x_n)=P\{X_1\le x_1,X_2\le x_2,\cdots,X_n\le x_n\}
$$

**边缘分布** (marginal distribution)：分布函数$F_X, F_Y$称为$X,Y$的边缘分布。边缘分布可以通过$X$和$Y$的联合分布得到
$$
F_X(x)=P\{X\le a\}=P\{X\le x,Y<\infin\}
=F(x,\infin)
$$
**联合密度函数** (jointly probability density function) ：$f(x,y)$表示随机变量$(X,Y)$分布在$(x,y)$附近的可能性大小。
$$
P\{x<X<x+\mathrm{d}x,y<Y<y+\mathrm{d}y\}\approx f(x,y)\mathrm{d}x\mathrm{d}y
$$


- 性质：

  - $f(x,y)\ge 0$

  - $$
    \int_{-\infin}^{+\infin}\int_{-\infin}^{+\infin}f(x,y)\mathrm{d}x\mathrm{d}y=1
    $$

  - $$
    f(x,y)=\frac{\part^2 F(x,y)}{\part x\part y}
    $$

  - 对$\R^2$上点集$C$，有
    $$
    P\{(X,Y)\in C\}=\underset{(x,y)\in C}{\iint}f(x,y)\mathrm{d}x\mathrm{d}y
    $$

- **联合连续** (jointly continuous) ：如果存在一个连续的$f(x,y)$函数，称$X,Y$​​是联合连续的

- **n个随机变量的联合连续**：对$n$维空间的点集$C$，
  $$
  P\{(X_1,X_2,\cdots,X_n)\in C\}=\underset{(x_1,x_2,\cdots,x_n)\in C}{\iint\cdots\int}f(x_1,x_2,\cdots,x_n)\mathrm{d}x_1\mathrm{d}x_2\cdots\mathrm{d}x_n
  $$
  称这$n$个随机变量为联合连续的

- **n个随机变量的联合密度函数**：上式的$f(x_1,x_2,\cdots,x_n)$称为n个随机变量的联合密度函数

**边缘密度函数**：密度函数$f_X,f_Y$称为随机变量$X,Y$的边缘密度函数。边缘密度函数可以通过联合密度函数得到
$$
f_X(x)=\int_{-\infin}^{+\infin}f(x,y)\mathrm{d}y\\
  P\{X\in A\}=P\{X\in A,Y\in(-\infin,+\infin)\}=\int_Af_X(x)\mathrm{d}x\\
  f_Y(y)=\int_{-\infin}^{+\infin}f(x,y)\mathrm{d}x\\
  P\{Y\in B\}=P\{X\in(-\infin,+\infin),Y\in B\}=\int_B f_Y(y)\mathrm{d}y
$$

- 性质：$f(x,y)=f_X(x)\cdot f_Y(y)$

### 离散型随机变量

**联合概率分布列**：
$$
p(x,y)=P\{X=x, Y=y\}
$$

- **概率分布表**：联合概率分布列可以通过概率分布表来表示

  | j\\i | 0             | 1             | 2             |
  | ---- | ------------- | ------------- | ------------- |
  | 0    | 0             | $\frac{1}{8}$ | $\frac{1}{8}$ |
  | 1    | $\frac{1}{8}$ | $\frac{1}{8}$ | $\frac{1}{2}$ |

**边缘分布列**：分布列$p_X,p_Y$称为$X,Y$​的边缘分布列，可以通过$X,Y$的联合分布列得到
$$
p_X(x)=P\{X=x\}=\sum_{y:p(x,y)>0}p(x,y)
$$
**联合概率分布函数**：
$$
F(x,y)=P\{X\le x,Y\le y\}
$$
**多项分布**：考虑$n$​次独立重复试验，每次实验有$r$​种可能的结果，各自发生的概率为$p_1,p_2\cdots,p_r$, $\sum_{i=1}^r p_i=1$，令$X_i$表示n次试验中第i个结果出现的次数，那么
$$
P\{X_1=n_1,X_2=n_2\cdots,X_r=n_r\}=\frac{n!}{n_1!n_2!\cdots n_r!}p_1^{n_1}p_2^{n_2}\cdots p_r^{n_r}\\
\text{Whenever }\sum_{i=1}^rn_i=n
$$
称随机变量$X_1,X_2,\cdots,X_r$服从多项分布

## 独立随机变量

**独立随机变量**：随机变量$X$和$Y$是独立的，如果对于实数集$A$, $B$: 
$$
P\{X\in A,Y\in B\}=P\{X\in A\}P\{Y\in B\}
$$
由联合分布函数可知，随机变量$X$和$Y$是独立的，如果
$$
F(x,y)=F_X(x)F_Y(y)
$$
对于离散型随机变量$X$​和$Y$​，二者是独立的，如果
$$
p(x,y)=p_X(x)p_Y(y)
$$
对于连续型随机变量$X$和$Y$，二者联合连续，则二者是独立的，如果
$$
f(x,y)=f_X(x)f_Y(y)
$$
如果随机变量$X$​和$Y$​​​二者不独立，则称二者是**相依**的。

对于随机变量$X_1,X_2,\cdots,X_n$，如果满足以下条件，对于任何实数集合：$A_1,A_2,\cdots,A_n$，有
$$
P\{X_1\in A_1,X_2\in A_2,\cdots,X_n\in A_n\}=\prod_{i=1}^n P\{X_i\in A_i\}
$$

- **性质**：如果$X$和$Y$独立，那么
  - $f(X)$​和$g(Y)$​独立
  - $a_1X+b_1Y$和$a_2X+b_2Y$独立

- **蒲丰投针问题**：桌上一组平行线，两两之间距离均为$D$，向桌面上随机投掷一个长度为$L(L\le D)$​的针，针与桌面上某一个平行线相交的概率有多大?

  从针的中点向最近的平行线引一条垂直线，设这条垂线为$X$；针与垂直线的夹角为$\theta$，那么针与平行线相交，当
  $$
  \frac{X}{\cos\theta}<\frac{L}{2}\quad\text{i.e.}
  \quad X<\frac{L}{2}\cos\theta
  $$
  ![Buffon](/assets/probability_7.png)

  假定$X$​和$\theta$在各自取值范围内服从均匀分布，因此
  $$
  P\{X<\frac{L}{2}\cos\theta\}=\underset{X<\frac{L}{2}\cos y}{\iint}f_X(x)f_\theta(y)\mathrm{d}x\mathrm{d}y=\frac{2L}{\pi D}
  $$

- **半衰期**：设$N(t)$表示$t$时刻中矿物中放射性物质的含量，根据经验事实，放射性物质随时间变化的规律为
  $$
  N(t)=2^{-\frac{t}{h}}N(0)\qquad t>0
  $$
  其中$h$称为半衰期；公共分布服从无记忆分布（指数分布），则考虑海量放射性粒子时，记$L$为裂变粒子的寿命，有
  $$
  P\{L<t\}=1-2^{-\frac{t}{h}}=1-\exp\{-t\frac{\ln 2}{h}\}
  $$

## 卷积

### 离散型随机变量函数

对于随机变量函数$Z=f(X,Y)$，其概率分布列为
$$
p(z=f(x,y))=P\{Z=f(X,Y)\}
$$

### 连续性随机变量函数

对于随机变量函数$Z=g(X,Y)$，其密度函数求解方法为
$$
F_Z(z)=P\{Z\le z\}=P\{g(X,Y)\le z\}=\underset{D_z}{\iint}f(x,y)\mathrm{d}x\mathrm{d}t\\
\text{Whenever }D_z=\{(x,y):g(x,y)\le z\}
$$
之后，求出
$$
f_z(z)=\frac{\mathrm{d}F_Z(z)}{\mathrm{d}z}
$$

### 卷积

特别地，假定$X$和$Y$是相互独立的连续性随机变量，其密度函数为$f_X$和$f_Y$，定义其分布函数$F_{X+Y}$​称为分布函数$X$和$Y$​的卷积；
$$
F_{X+Y}(a)=P\{X+Y\le a\}=\underset{x+y\le a}{\iint}f_X(x)f_Y(y)\mathrm{d}x\mathrm{d}y=\int_{-\infin}^{+\infin}\int_{-\infin}^{a-y}f_X(x)\mathrm{d}xf_Y(y)\mathrm{d}y\\
=\int_{-\infin}^{+\infin}F_X(a-y)f_Y(y)\mathrm{d}y
$$
求导得到$X+Y$的密度函数
$$
f_{X+Y}(a)=\int_{-\infin}^{+\infin}f_X(a-y)f_Y(y)\mathrm{d}y
$$

- **均匀分布的卷积**：对于$X\sim U(0,1), Y\sim U(0, 1)$，有：
  $$
  f_{X+Y}(a)=\begin{cases}
  a&0\le a\le1\\
  2-a&1<a<2\\
  0&\text{else}
  \end{cases}
  $$
  ![Convolution](/assets/probability_8.png)

- **$\bold\Gamma$​​​分布的卷积**：$X$​​服从参数为$(s,\lambda)$​​的$\Gamma$​​分布，$Y$​​服从参数为$(t,\lambda)$​​的$\Gamma$​​分布，则$X+Y$​​服从参数为$(s+t,\lambda)$​​的$\Gamma$​​​分布；对于$X_i\sim\Gamma(t_i,\lambda)$​​，那么$\sum_{i=1}^nX_i\sim\Gamma(\sum_{i=1}^nt_i, \lambda)$​

- **$\bold\chi^2$​​​​分布**：​如果$Z_1,Z_2,\cdots,Z_n$​​是相互独立的标准正态随机变量($Z_i\sim N(0,1)$​​)，那么称$Y\equiv\sum_{i=1}^nZ_i^2$​​是服从自由度为$n$​​的卡方随机变量($\chi^2$​)；自由度为$n$​的$\chi^2$​分布就是参数为$(\frac{n}{2},\frac{1}{2})$​​的$\Gamma$分布
  $$
  f_Y(y)=\frac{\mathrm e^{-\frac{y}{2}}y^{\frac n 2-1}}{2^{\frac n 2}\Gamma(\frac n 2)}\qquad y>0
  $$

- **正态分布的卷积**：若$X_i\sim N(\mu_i,\sigma_i^2)$，则$\sum_{i=1}^nX_i\sim N(\sum_{i=1}^n\mu_i^2, \sum_{i=1}^n\sigma_i^2)$

- **Possion分布的卷积**：若$X\sim P(\lambda_1)$，$Y\sim P(\lambda_2)$，那么$X+Y\sim P(\lambda_1+\lambda_2)$

- **二项分布的卷积**：若$X\sim B(n,p)$，$Y\sim B(m,p)$，那么$X+Y\sim B(n+m,p)$

## 条件分布

**条件分布**：条件分布指在某事件已经发生的前提下，某随机变量的分布函数
$$
F(x|A)=P\{X\le x|A\}
$$

### 离散型随机变量

**条件分布列**：在已知$Y=y$的条件下，$X$的分布列为
$$
p_{X|Y}(x|y)=P\{X=x|Y=y\}=\frac{p(x,y)}{p_Y(y)}
$$
**条件分布函数**：在已知$Y=y$的条件下，$X$的条件分布函数为
$$
F_{X|Y}(x|y)=P\{X\le x|Y=y\}=\sum_{a\le x}p(a,y)
$$
**条件分布，X和Y独立**：如果$X$和$Y$独立，那么条件分布列和条件分布函数和与通常的分布列和分布函数是一样的
$$
p_{X|Y}(x|y)=\frac{P\{X=x,Y=y\}}{P\{Y=y\}}=\frac{P\{X=x\}P\{Y=y\}}{P\{Y=y\}}=p_X(x)
$$

### 连续型随机变量

**条件密度函数**：如果$X$和$Y$具有联合密度函数$f(x,y)$那么在给定$Y=y$的条件下，$X$的条件密度函数如下定义
$$
f_{X|Y}(x|y)=\frac{f(x,y)}{f_Y(y)}
$$
表示对于当$Y$取值在$y$和$y+\mathrm{d}y$之间时，$X$取值于$x$和$x+\mathrm{d}x$之间的概率：
$$
f_{X|Y}(x|y)\mathrm{d}x=\frac{P\{x\le X\le x+\mathrm{d}x, y\le Y\le y+\mathrm{d}y \}}{P\{y\le Y\le y+\mathrm{d}y\}}
$$
**条件分布函数**：已知$Y=y$​的条件下$X$的的条件分布函数如下
$$
F_{X|Y}\equiv P\{X\le a|Y=y\}=\int_{-\infin}^x f_{X|Y}(x|y)\mathrm{d}x
$$
**条件密度，X和Y独立**：在X和Y独立的前提下，X的条件密度和非条件密度一样
$$
f_{X|Y}=\frac{f_X(x)f_Y(y)}{f_Y(y)}=f_X(x)
$$

- **t分布**：如果$Z$和$Y$独立，$Z\sim N(0, 1)$, $Y\sim\chi^2(n)$，那么定义随机变量$T$
  $$
  T=\frac{Z}{\sqrt{\frac{Y}{n}}}=\sqrt{n}\frac{Z}{\sqrt{Y}}
  $$
  称之为自由度为$n$的t分布。t分布的密度函数为
  $$
  f_T(t)=\int_0^\infin f_{T,Y}(t,y)\mathrm{d}y=\frac{\Gamma(\frac{n+1}{2})}{\sqrt{\pi n}\Gamma(\frac{n}{2})}(1+\frac{t^2}{n})^{-\frac{(n+1)}{2}}\qquad-\infin<t<+\infin
  $$

- **二元正态分布**：$X,Y$服从二元正态分布，如果对于常数$\mu_x, \mu_y, \sigma_x>0, \sigma_y>0, -1<\rho<1, -\infin<x,y<+\infin$，其联合密度函数有如下形式：
  $$
  f(x,y)=\frac{1}{2\pi\sigma_x\sigma_y\sqrt{1-\rho^2}}\exp\Bigg\{-\frac{1}{2(1-\rho^2)}\bigg[\Big(\frac{x-\mu_x}{\sigma_x}\Big)^2+\Big(\frac{y-\mu_y}{\sigma_y}\Big)^2-2\rho\frac{(x-\mu_x)(y-\mu_y)}{\sigma_x\sigma_y}\bigg]\Bigg\}
  $$
  
